---
title: "Métodos Computacionais para Análise de Risco"
author: 'Prof.: Thais Paiva'

date: "30 de junho de 2023"
subtitle: "Apresentação Trabalho Final"

output:
  ioslides_presentation:
    highlight: pygments
    widescreen: TRUE
    incremental: true
    transition: faster
    css: "custom2.css"

  
---
```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
library(tidyverse)
if(!require(ggthemes)){install.packages("ggthemes");library(ggthemes)}
if(!require(gt)){install.packages("gt");library(gt)}
library(RColorBrewer)
library(CASdatasets)
tema <- theme_hc()+ theme(axis.title.y = element_text(angle = 90,
                                                      margin = margin(0.1, 0.5, 0.3, 0, "cm")),
                          legend.position = "right",
                          plot.margin = margin(0.2, 0.3, 0.3, 0.3, "cm"))
theme_set(tema)

data(ustermlife)

dados <- ustermlife


?ustermlife

str(dados)

```



#  Banco de dados {data-background=#C1D6DB}

## Banco de dados

O banco de dados se trata de uma amostra representativa dos EUA que contém informações sobre consumidores e potenciais consumidores de seguros de vida. As informações foram obtidas de uma amostra aleatória de 500 agregados familiares, a partir do Questionário de Finanças dos Consumidores (SCF) realizado em 2004.  

# Objetivos {data-background=#C1D6DB}

## Objetivos

- Estudamos como o valor da variável FACE, o montante que a empresa pagará em caso de morte do segurado nomeado, é afetada por outras variáveis determinantes do consumidor.
- skhdkshdlais
- diuahsduhausk

- dushdasdkjsadjasbdskjdbjkasbdkjsab

# Análise descritiva {data-background=#C1D6DB}

## Análise da variável resposta "Face"

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(fitdistrplus)
denscomp(fitdist(log(dados$Face), "norm"), legendtext=c("Curva normal ajustada"), demp=T,
         main="Histograma e densidades ajustadas", xlegend=7, ylegend=0.2)
```

## Análise descritiva das variáveis explicativas

```{r echo=FALSE, message=FALSE, warning=FALSE}

dados %>%  ggplot()+
  geom_bar(aes(x = as.factor(Gender), y = Age, fill= as.factor(Ethnicity)), 
           stat="identity", position=position_dodge()) +
  labs(x = "Gênero", y = "Idade", title = "Idade X Sexo X Etnia")+
  scale_fill_manual(name="Etnia",labels=c("1", "2", "3", "7"), 
                    values = c("#D7484A", "#A1C6CF", "#323C56", "#D78763"))+
  scale_x_discrete(labels=c("0" = "X", "1" ="Y"))


```

# Modelagem {data-background=#C1D6DB}

## Modelagem 

Vimos que a variável FACE possui distribuição Normal quando transformada com o log(). Por este motivo usaremos, a princípio, um modelo Gaussiano para o log da variável FACE. Também aplicamos log à variável Income, a fim de controle de escala.

```{r}
ajuste_logNorm <- glm(log(Face)~factor(Gender)+factor(MarStat)
                      +idade2+ sidade2+ Education+ Seducation +(NumHH)
                      +log(Income)+ (Charity),
                      data = base_LI, family = gaussian(link = "identity"))
summary(ajuste_logNorm)
```

Vimos que as variáveis *idade2*, sidade2, Seducation e MarStat **não foram significativas** para o modelo.

```{r}
ajuste_logNorm <- glm(log(Face)~factor(Gender)
                      + Education +(NumHH)
                      +log(Income)+ (Charity),
                      data = base_LI, family = gaussian(link = "identity"))
summary(ajuste_logNorm)
```

Testando multicolinearidade entre as explicativas:

```{r}
library(car)
vif(ajuste_logNorm)
```

Talvez se adicionarmos termos de interação entre explicativas o problema seja resolvido. Isso irá ocorrer se a relação entre as explicativas não for linear.

```{r}

```

Testando novamente a existência de multicolinearidade:

```{r}
library(car)
vif(ajuste_logNorm)
```

Testamos também com o modelo Gamma, sem transformação da variável resposta, e constatamos uma Deviance e BIC menores.

```{r}
ajuste_gamma <- glm(Face~factor(Gender)
                      + Education +(NumHH)
                      +log(Income)+ (Charity),
                    data = base_LI, family = Gamma(link = "log"))
summary(ajuste_gamma)
```

Comparando BIC:

```{r}
BIC(ajuste_logNorm)
BIC(ajuste_gamma)
```

# Conclusões {data-background="#C1D6DB"}

## Conclusões

-   Vimos que a variável FACE, o valor da indenização do seguro de vida pago pela empresa, pode ser explicado por características do segurado. Dentre elas, o número de pessoas vivendo na casa, o log da renda do segurado, o número de anos de educação do segurado e o valor das contribuições do segurado para a caridade. Também vimos que o modelo Gamma foi o melhor.

- Você pode usar *texto em itálico* ou **em negrito**.

- Para mudar a cor, é preciso usar [código html](https://bookdown.org/yihui/rmarkdown/ioslides-presentation.html#text-color):

  - <span class="blue3">Azul</span>, <span class="red">vermelho</span>, <span class="green2">verde</span>, <span class="black">preto</span>, <span class="yellow3">amarelo</span>.
  

 - **Fórmulas** podem ser incluídas usando Latex: $\sigma^2$ (na mesma linha do texto), ou em destaque

$$ \bar{X} = \sum_{i=1}^n \frac{X_i}{n} $$




## Novo Slide 

- O texto em cada slide é incluído assim como um arquivo `rmarkdown` usual.

- Você pode usar *texto em itálico* ou **em negrito**.

- Para mudar a cor, é preciso usar [código html](https://bookdown.org/yihui/rmarkdown/ioslides-presentation.html#text-color):

  - <span class="blue3">Azul</span>, <span class="red">vermelho</span>, <span class="green2">verde</span>, <span class="black">preto</span>, <span class="yellow3">amarelo</span>.
  

 - **Fórmulas** podem ser incluídas usando Latex: $\sigma^2$ (na mesma linha do texto), ou em destaque

$$ \bar{X} = \sum_{i=1}^n \frac{X_i}{n} $$


## Código em R 

- Vocês irão entregar apenas <span class="red3">**1 (um) arquivo .Rmd**</span>, que deverá incluir tanto o conteúdo da apresentação, como todo o código para executar as análises.

- O código deve ser incluído usando os *chunks* como vocês já estão acostumados. 

- Lembre-se de usar as opções como `echo=FALSE`, `message=FALSE`, `warning=FALSE` quando vocẽs não quiserem mostrar o código e as mensagens de erro nos slides. 

- Para mais detalhes sobre opções de *chunk*: <https://rmarkdown.rstudio.com/lesson-3.html>


## Gráficos

- Para incluir um gráfico, coloque o código em um chunk separado, e use as opções `fig.align='center'` para centralizar, e `fig.width` e `fig.height` para controlar o tamanho (default é 7).

```{r echo=FALSE, fig.align='center', fig.heigth=3, fig.width=5}
plot(1:10,1:10, pch=1:10, col=1:10)
```


## Para mais detalhes

- <https://rmarkdown.rstudio.com/ioslides_presentation_format.html>


- Ou me procure: [thaispaiva@est.ufmg.br](mailto:thaispaiva@est.ufmg.br).

  
  
  # Nova seção  {data-background=#C1D6DB}
